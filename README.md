# EEGdecoding_SQM
We present in this repository the code and data necessary to reproduce the results shown in Men√©trey, Herzog & Pascucci. Neural evidence for a two-stage model of visual processing. 
Preprint: https://www.biorxiv.org/content/10.1101/2024.11.15.623853v1

In this study, we analyzed EEG recordings from 18 participants during the Sequential Metacontrast Paradigm (SQM), where a stream of lines and vernier offsets is unconsciously integrated over several hundred milliseconds (for additional information about the SQM paradigm, see Drissi et al., 2021; https://doi.org/10.1038/s41467-019-12919-7). Five conditions were randomly presented: a condition without any vernier (NV, only a sequence of straight lines), three conditions with one single vernier in the attended stream (V0/V2/V4, with a vernier in the central line, the second, or the fourth flanker line), and two conditions with two opposite vernier offsets in the attended stream (V0-AV2 or V0-AV4, with a vernier in the central line and a vernier with an opposite offset in the second or fourth flanker line). Participants were asked to report the perceived vernier offset.

# 1. System requirements
Software, toolboxes, and functions required:
MATLAB (MathWorks Inc., Natick, MA, USA): The scripts were executed using MATLAB R2022b.
EEGLAB: The scripts were executed using EEGLAB v2021.1, which can be downloaded from the official EEGLAB website (https://sccn.ucsd.edu/eeglab/download.php).
Custom-made functions written in MATLAB, which can be downloaded from this repository (EEGdecoding_SQM/Functions).

# 2. Installation guide
To reproduce the results shown in the manuscript, download all the files in this repository, maintaining the same folder structure. In the Data folder, add the original data (preprocessed EEG data and behavioral data), which can be downloaded here: https://osf.io/d83vs/.

# 3. Instruction for use
Before running the scripts provided in 1.PrepareDataForAnalyses or 2.Analyses, ensure the main path is updated to reflect the location of the Data folder. Additionally, add both EEGLAB and the Functions folder to the MATLAB path.

1. PrepareDataForAnalyses:
- PrepareEEGdata.m: Prepares the data for decoding analyses from the preprocessed EEG recordings and behavioral data. EEG data are resampled, re-epoched (-0.2 to 1 s), and z-scored. The .mat files generated by this script, which are needed for the following analyses, are also available directly in the repository (EEGdecoding_SQM/Data).

2. Analyses
- Behavioral: Plots and compares performance between each condition. Performance is determined as the proportion of responses that matched the direction of the first presented vernier offset in the stream.
- Decoding: Performs EEG decoding between conditions (e.g., NV condition vs. V conditions, NV condition vs. V-AV conditions, correct vs. incorrect reports in V conditions, etc.), saves the decoder results for each participant in .mat files, and plots the results.

3. Results
- Decoding: All decoder results obtained with each script are available in the repository.
- Figures: All figures created by each script are available in the repository.
  
# 4. Demo
A demo with EEG decoding between NV conditions and the three V conditions is provided using the data from one participant. The runtime, which can vary from a few seconds to several minutes, depends on the chosen parameters (e.g., number of iterations (opt.niter), type of cross-validation (opt.CVtype), etc.).
